import{_ as Pe}from"./weTs8tLg.js";import{d as D,v as L,a as k,aT as We,D as Me,aU as qe,a2 as Ee,o as a,m as g,w as h,c as v,J as N,j as r,t as B,f as p,h as e,l as E,aV as Je,g as je,k as b,p as J,aj as te,al as U,i as ve,ab as Xe,af as Ye,$ as I,a0 as X,an as Ze,ap as Qe,aJ as ge,aN as we,aW as et,Y as Le,u as be,ao as F,aX as tt,aY as ne,aD as Ce,a3 as ye,A as he,q as M,aZ as q,a_ as Ue,a$ as Q,b0 as nt,aS as ke,s as ot,b as st,N as oe,O as at,x as it,P as lt,L as H,R as Se,S as Ae,T as Y,U as rt,V as Be,W as ut,X as Re,b1 as Te,b2 as pe,b3 as xe,b4 as De,b5 as $e,E as ct,b6 as dt,b7 as mt,b8 as pt,b9 as vt,ag as ft,ba as gt,bb as ze,aI as bt,aF as ee,K as fe,bc as yt,bd as He,be as ht,bf as kt,bg as $t,bh as _t,bi as wt,a1 as Ct,bj as St,bk as Z,bl as At,aE as Bt,a4 as Ne,bm as Ie,a9 as Rt,n as Tt,bn as xt,ad as Dt,ae as Nt}from"./CMcu4vOi.js";import{s as It}from"./CziPTEgh.js";import{c as Pt}from"./Cy5WKwqU.js";import{_ as Fe}from"./BwHuf7fG.js";import{u as Oe,g as Ve}from"./VKdB9Mfh.js";import{_ as Mt}from"./DDd3r5-x.js";import{_ as Et}from"./sfWYJY5J.js";import{_ as jt}from"./Brx9_43Z.js";const Lt=r("div",{"i-ri-discuss-line":"","text-blue":""},null,-1),Ut=r("div",{"i-ri-chat-1-line":"","text-blue":""},null,-1),zt={"ws-nowrap":"",flex:""},Ht=D({__name:"StatusReplyingTo",props:{status:{},isSelfReply:{type:Boolean}},setup(l){const t=l,s=L(),i=L(!1),d=k(()=>t.status.inReplyToAccountId===t.status.account.id),n=L(d.value?t.status.account:void 0);return We(s,([{intersectionRatio:c}])=>{i.value=c>.1}),Me(()=>[t.status,i.value],([c,u])=>{if(c.account&&c.inReplyToAccountId===c.account.id){n.value=c.account;return}if(!u)return;const $=c.inReplyToAccountId;if($){qe(c.inReplyToAccountId).then(w=>{$===t.status.inReplyToAccountId&&(n.value=w)});return}n.value=void 0},{immediate:!0,flush:"post"}),(c,u)=>{const $=Pe,w=Ee("i18n-t"),A=J;return c.status.inReplyToId?(a(),g(A,{key:0,ref_key:"link",ref:s,flex:"~ gap2","items-center":"","h-auto":"","text-sm":"","text-secondary":"",to:("getStatusInReplyToRoute"in c?c.getStatusInReplyToRoute:e(Je))(c.status),title:c.$t("status.replying_to",[e(n)?("getDisplayName"in c?c.getDisplayName:e(je))(e(n)):c.$t("status.someone")]),"text-blue":"","saturate-50":"","hover:saturate-100":""},{default:h(()=>[c.isSelfReply?(a(),v(N,{key:0},[Lt,r("span",null,B(c.$t("status.show_full_thread")),1)],64)):(a(),v(N,{key:1},[Ut,r("div",zt,[p(w,{keypath:"status.replying_to"},{default:h(()=>[e(n)?(a(),g($,{key:0,account:e(n),link:!1,"m-inline-2":""},null,8,["account"])):(a(),v(N,{key:1},[E(B(c.$t("status.someone")),1)],64))]),_:1})])],64))]),_:1},8,["to","title"])):b("",!0)}}}),Ft=D({__name:"StatusAccountDetails",props:{account:{},link:{type:Boolean,default:!0}},setup(l){const t=te();return(s,i)=>{const d=Xe,n=Ye,c=J;return a(),g(c,{to:s.link?("getAccountRoute"in s?s.getAccountRoute:e(ve))(s.account):void 0,flex:"~ col","min-w-0":"","md:flex":"~ row gap-2","md:items-center":"","text-link-rounded":""},{default:h(()=>[p(d,{account:s.account,"hide-emojis":("getPreferences"in s?s.getPreferences:e(U))(e(t),"hideUsernameEmojis"),"font-bold":"","line-clamp-1":"","ws-pre-wrap":"","break-all":""},null,8,["account","hide-emojis"]),p(n,{account:s.account,class:"zen-none"},null,8,["account"])]),_:1},8,["to"])}}}),Ot=["aria-label"],Vt=D({__name:"StatusVisibilityIndicator",props:{status:{}},setup(l){const t=k(()=>It.find(s=>s.value===l.status.visibility));return(s,i)=>{const d=X;return a(),g(d,{content:s.$t(`visibility.${e(t).value}`),placement:"bottom"},{default:h(()=>[r("div",{class:I(e(t).icon),"aria-label":s.$t(`visibility.${e(t).value}`)},null,10,Ot)]),_:1},8,["content"])}}}),Kt={},Gt={class:"skeleton-loading-bg","h-5":"","w-full":"",rounded:"",my2:""};function Wt(l,t){return a(),v("div",Gt)}const qt=Ze(Kt,[["render",Wt]]),Jt=r("span",null,null,-1),Xt=D({__name:"StatusEditHistory",props:{status:{}},setup(l){const t=Qe().v1.statuses.$select(l.status.id).history.list();function s(n){et(n)}const i=ge();function d(n){return[...n].reverse()}return(n,c)=>{const u=Ee("i18n-t"),$=Le,w=qt,A=Pt;return a(),g(A,{paginator:e(t),"key-prop":"createdAt",preprocess:d},{default:h(({items:C,item:T,index:f})=>[p($,{px:"0.5",onClick:y=>s(T)},{default:h(()=>[E(B(("getDisplayName"in n?n.getDisplayName:e(je))(T.account))+" ",1),f===C.length-1?(a(),g(u,{key:0,keypath:"status_history.created"},{default:h(()=>[E(B(e(we)(new Date(T.createdAt),e(i))),1)]),_:2},1024)):(a(),g(u,{key:1,keypath:"status_history.edited"},{default:h(()=>[E(B(e(we)(new Date(T.createdAt),e(i))),1)]),_:2},1024))]),_:2},1032,["onClick"])]),loading:h(()=>[p(w),p(w,{op50:""}),p(w,{op25:""})]),done:h(()=>[Jt]),_:1},8,["paginator"])}}}),Yt=["title","datetime"],Zt={"text-sm":"",p2:""},Qt={"text-center":"",mb1:""},en=D({__name:"StatusEditIndicator",props:{status:{},inline:{type:Boolean}},setup(l){const t=k(()=>l.status.editedAt),s=be(t);return(i,d)=>{const n=X,c=Xt,u=Fe;return e(t)?(a(),v(N,{key:0},[i.inline?(a(),g(n,{key:0,content:i.$t("status.edited",[e(s)])},{default:h(()=>[E("   "),r("time",{title:e(t),datetime:e(t),"font-bold":"",underline:"","decoration-dashed":"","text-secondary":""}," * ",8,Yt)]),_:1},8,["content"])):(a(),g(u,{key:1},{popper:h(()=>[r("div",Zt,[r("div",Qt,B(i.$t("status.edited",[e(s)])),1),p(c,{status:i.status},null,8,["status"])])]),default:h(()=>[F(i.$slots,"default")]),_:3}))],64)):b("",!0)}}}),tn={"of-hidden":"",h:"1.25rem"},nn=D({__name:"AnimateNumber",props:{increased:{type:Boolean}},setup(l){return(t,s)=>(a(),v("div",tn,[r("div",{flex:"~ col","transition-transform":"","duration-300":"",class:I(t.increased?"translate-y--1/2":"translate-y-0")},[F(t.$slots,"default"),F(t.$slots,"next")],2)]))}}),on={"text-secondary-light":""},Ke=D({inheritAttrs:!1,__name:"StatusActionButton",props:{text:{},content:{},color:{},icon:{},activeIcon:{},inactiveIcon:{},hover:{},elkGroupHover:{},active:{type:Boolean},disabled:{type:Boolean},as:{default:"button"},command:{type:Boolean}},setup(l){const t=L();return tt({scope:"Actions",order:-2,visible:()=>l.command&&!l.disabled,name:()=>l.content,icon:()=>l.icon,onActivate(){if(!ne())return;const s=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t.value?.dispatchEvent(s)}}),(s,i)=>{const d=X,n=nn;return a(),g(ye(s.as),Ce(s.$attrs,{ref_key:"el",ref:t,"w-fit":"",flex:"","gap-1":"","items-center":"","transition-all":"","select-none":"",rounded:"",group:"",hover:s.disabled?void 0:s.hover,"focus:outline-none":"","focus-visible":s.hover,class:s.active?s.color:s.disabled?"op25 cursor-not-allowed":"text-secondary","aria-label":s.content,disabled:s.disabled,"aria-disabled":s.disabled}),{default:h(()=>[p(d,{placement:"bottom",content:s.content},{default:h(()=>[r("div",Ce({"rounded-full":"",p2:""},s.disabled?{}:{"elk-group-hover":s.elkGroupHover,"group-focus-visible":s.elkGroupHover,"group-focus-visible:ring":"2 current"}),[r("div",{class:I(s.active&&s.activeIcon?s.activeIcon:s.disabled&&s.inactiveIcon?s.inactiveIcon:s.icon)},null,2)],16)]),_:1},8,["content"]),s.text!==void 0||s.$slots.text?(a(),g(n,{key:0,increased:s.active,"text-sm":""},{next:h(()=>[r("span",{class:I([s.color])},[F(s.$slots,"text",{},()=>[E(B(s.text),1)])],2)]),default:h(()=>[r("span",on,[F(s.$slots,"text",{},()=>[E(B(s.text),1)])])]),_:3},8,["increased"])):b("",!0)]),_:3},16,["hover","focus-visible","class","aria-label","disabled","aria-disabled"])}}});function Ge(l){const t=L({...l.status}),{client:s}=he();Me(()=>l.status,C=>t.value={...C},{deep:!0,immediate:!0});const i=L({reblogged:!1,favourited:!1,bookmarked:!1,pinned:!1,translation:!1,muted:!1});async function d(C,T,f){if(!ne())return;const y=f?t.value[f]:void 0;i.value[C]=!0;const _=t.value[C];T().then(P=>{_&&f&&y===P[f]&&(P[f]-=1),Object.assign(t,P),q(P,void 0,!0)}).finally(()=>{i.value[C]=!1}),t.value[C]=!t.value[C],q(t.value,void 0,!0),f&&(t.value[f]+=t.value[C]?1:-1)}const n=k(()=>t.value.visibility!=="direct"&&(t.value.visibility!=="private"||t.value.account.id===M.value?.account.id));return{status:t,isLoading:i,canReblog:n,toggleMute:async()=>d("muted",()=>s.value.v1.statuses.$select(t.value.id)[t.value.muted?"unmute":"mute"]()),toggleReblog:()=>d("reblogged",()=>s.value.v1.statuses.$select(t.value.id)[t.value.reblogged?"unreblog":"reblog"]().then(C=>t.value.reblogged?C.reblog:C),"reblogsCount"),toggleFavourite:()=>d("favourited",()=>s.value.v1.statuses.$select(t.value.id)[t.value.favourited?"unfavourite":"favourite"](),"favouritesCount"),toggleBookmark:()=>d("bookmarked",()=>s.value.v1.statuses.$select(t.value.id)[t.value.bookmarked?"unbookmark":"bookmark"]()),togglePin:async()=>d("pinned",()=>s.value.v1.statuses.$select(t.value.id)[t.value.pinned?"unpin":"pin"]())}}const sn={flex:"~ col"},an=D({__name:"StatusActionsMore",props:{status:{},details:{type:Boolean},command:{type:Boolean}},emits:["afterEdit"],setup(l,{emit:t}){const s=l,i=t,d=Ue("focus-editor",Q),{status:n,isLoading:c,toggleBookmark:u,toggleFavourite:$,togglePin:w,toggleReblog:A,toggleMute:C}=Ge(s),T=nt(),f=ke(),y=ot(),{t:_}=st(),P=te(),j=oe("useStarFavoriteIcon"),z=k(()=>n.value.account.id===M.value?.account.id),{client:V}=he();function S(o){const m=mt(o);return m?`${location.origin}/${m}`:null}async function O(o){const m=S(o);m&&await T.copy(m)}async function K(o){const m=o.url;m&&await T.copy(m)}const{share:se,isSupported:G}=at();async function W(o){const m=S(o);m&&await se({url:m})}async function ae(){(await Re({title:_("confirm.delete_posts.title"),description:_("confirm.delete_posts.description"),confirm:_("confirm.delete_posts.confirm"),cancel:_("confirm.delete_posts.cancel")})).choice==="confirm"&&(Te(n.value.id),await V.value.v1.statuses.$select(n.value.id).remove(),y.name==="status"&&f.back())}async function ie(){(await Re({title:_("confirm.delete_posts.title"),description:_("confirm.delete_posts.description"),confirm:_("confirm.delete_posts.confirm"),cancel:_("confirm.delete_posts.cancel")})).choice==="confirm"&&(Te(n.value.id),await V.value.v1.statuses.$select(n.value.id).remove(),await pe("dialog",await xe(n.value),!0),De.value&&y.name==="status"&&f.push($e(De.value)))}function le(){if(ne())if(s.details)d();else{const{key:o,draft:m}=ct(n.value);pe(o,m())}}async function re(){await pe(`edit-${n.value.id}`,{...await xe(n.value),editingStatus:n.value},!0),i("afterEdit")}function ue(){dt(n.value.id)}return(o,m)=>{const ce=Ke,R=Le,de=J,me=Fe;return a(),g(me,{"flex-none":"",ms3:"",placement:"bottom","eager-mount":o.command},{popper:h(()=>[r("div",sn,[("getPreferences"in o?o.getPreferences:e(U))(e(P),"zenMode")&&!o.details?(a(),v(N,{key:0},[p(R,{text:o.$t("action.reply"),icon:"i-ri:chat-1-line",command:o.command,onClick:m[0]||(m[0]=x=>le())},null,8,["text","command"]),p(R,{text:e(n).reblogged?o.$t("action.boosted"):o.$t("action.boost"),icon:"i-ri:repeat-fill",class:I(e(n).reblogged?"text-green":""),command:o.command,disabled:e(c).reblogged,onClick:m[1]||(m[1]=x=>e(A)())},null,8,["text","class","command","disabled"]),p(R,{text:e(n).favourited?o.$t("action.favourited"):o.$t("action.favourite"),icon:e(j)?e(n).favourited?"i-ri:star-fill":"i-ri:star-line":e(n).favourited?"i-ri:heart-3-fill":"i-ri:heart-3-line",class:I(e(n).favourited?e(j)?"text-yellow":"text-rose":""),command:o.command,disabled:e(c).favourited,onClick:m[2]||(m[2]=x=>e($)())},null,8,["text","icon","class","command","disabled"]),p(R,{text:e(n).bookmarked?o.$t("action.bookmarked"):o.$t("action.bookmark"),icon:e(n).bookmarked?"i-ri:bookmark-fill":"i-ri:bookmark-line",class:I(e(n).bookmarked?e(j)?"text-rose":"text-yellow":""),command:o.command,disabled:e(c).bookmarked,onClick:m[3]||(m[3]=x=>e(u)())},null,8,["text","icon","class","command","disabled"])],64)):b("",!0),p(R,{text:o.$t("menu.show_favourited_and_boosted_by"),icon:"i-ri:hearts-line",command:o.command,onClick:m[4]||(m[4]=x=>ue())},null,8,["text","command"]),p(R,{text:o.$t("menu.copy_link_to_post"),icon:"i-ri:link",command:o.command,onClick:m[5]||(m[5]=x=>O(e(n)))},null,8,["text","command"]),p(R,{text:o.$t("menu.copy_original_link_to_post"),icon:"i-ri:links-fill",command:o.command,onClick:m[6]||(m[6]=x=>K(e(n)))},null,8,["text","command"]),e(G)?(a(),g(R,{key:1,text:o.$t("menu.share_post"),icon:"i-ri:share-line",command:o.command,onClick:m[7]||(m[7]=x=>W(e(n)))},null,8,["text","command"])):b("",!0),("currentUser"in o?o.currentUser:e(M))&&(e(n).account.id===("currentUser"in o?o.currentUser:e(M)).account.id||e(n).mentions.some(x=>x.id===("currentUser"in o?o.currentUser:e(M)).account.id))?(a(),g(R,{key:2,text:e(n).muted?o.$t("menu.unmute_conversation"):o.$t("menu.mute_conversation"),icon:e(n).muted?"i-ri:eye-line":"i-ri:eye-off-line",command:o.command,disabled:e(c).muted,onClick:m[8]||(m[8]=x=>e(C)())},null,8,["text","icon","command","disabled"])):b("",!0),e(n).url?(a(),g(de,{key:3,to:e(n).url,external:"",target:"_blank"},{default:h(()=>[p(R,{text:o.$t("menu.open_in_original_site"),icon:"i-ri:arrow-right-up-line",command:o.command},null,8,["text","command"])]),_:1},8,["to"])):b("",!0),("isHydrated"in o?o.isHydrated:e(it))&&("currentUser"in o?o.currentUser:e(M))?(a(),v(N,{key:4},[e(z)?(a(),v(N,{key:0},[p(R,{text:e(n).pinned?o.$t("menu.unpin_on_profile"):o.$t("menu.pin_on_profile"),icon:"i-ri:pushpin-line",command:o.command,onClick:e(w)},null,8,["text","command","onClick"]),p(R,{text:o.$t("menu.edit"),icon:"i-ri:edit-line",command:o.command,onClick:re},null,8,["text","command"]),p(R,{text:o.$t("menu.delete"),icon:"i-ri:delete-bin-line","text-red-600":"",command:o.command,onClick:ae},null,8,["text","command"]),p(R,{text:o.$t("menu.delete_and_redraft"),icon:"i-ri:eraser-line","text-red-600":"",command:o.command,onClick:ie},null,8,["text","command"])],64)):(a(),v(N,{key:1},[p(R,{text:o.$t("menu.mention_account",[`@${e(n).account.acct}`]),icon:"i-ri:at-line",command:o.command,onClick:m[9]||(m[9]=x=>("mentionUser"in o?o.mentionUser:e(lt))(e(n).account))},null,8,["text","command"]),e(H)(e(n).account).value?.muting?(a(),g(R,{key:1,text:o.$t("menu.unmute_account",[`@${e(n).account.acct}`]),icon:"i-ri:volume-up-fill",command:o.command,onClick:m[11]||(m[11]=x=>e(Se)(e(H)(e(n).account).value,e(n).account))},null,8,["text","command"])):(a(),g(R,{key:0,text:o.$t("menu.mute_account",[`@${e(n).account.acct}`]),icon:"i-ri:volume-mute-line",command:o.command,onClick:m[10]||(m[10]=x=>e(Se)(e(H)(e(n).account).value,e(n).account))},null,8,["text","command"])),e(H)(e(n).account).value?.blocking?(a(),g(R,{key:3,text:o.$t("menu.unblock_account",[`@${e(n).account.acct}`]),icon:"i-ri:checkbox-circle-line",command:o.command,onClick:m[13]||(m[13]=x=>e(Ae)(e(H)(e(n).account).value,e(n).account))},null,8,["text","command"])):(a(),g(R,{key:2,text:o.$t("menu.block_account",[`@${e(n).account.acct}`]),icon:"i-ri:forbid-2-line",command:o.command,onClick:m[12]||(m[12]=x=>e(Ae)(e(H)(e(n).account).value,e(n).account))},null,8,["text","command"])),("getServerName"in o?o.getServerName:e(Y))(e(n).account)&&("getServerName"in o?o.getServerName:e(Y))(e(n).account)!==("currentServer"in o?o.currentServer:e(rt))?(a(),v(N,{key:4},[e(H)(e(n).account).value?.domainBlocking?(a(),g(R,{key:1,text:o.$t("menu.unblock_domain",[("getServerName"in o?o.getServerName:e(Y))(e(n).account)]),icon:"i-ri:restart-line",command:o.command,onClick:m[15]||(m[15]=x=>("toggleBlockDomain"in o?o.toggleBlockDomain:e(Be))(e(H)(e(n).account).value,e(n).account))},null,8,["text","command"])):(a(),g(R,{key:0,text:o.$t("menu.block_domain",[("getServerName"in o?o.getServerName:e(Y))(e(n).account)]),icon:"i-ri:shut-down-line",command:o.command,onClick:m[14]||(m[14]=x=>("toggleBlockDomain"in o?o.toggleBlockDomain:e(Be))(e(H)(e(n).account).value,e(n).account))},null,8,["text","command"]))],64)):b("",!0),p(R,{text:o.$t("menu.report_account",[`@${e(n).account.acct}`]),icon:"i-ri:flag-2-line",command:o.command,onClick:m[16]||(m[16]=x=>("openReportDialog"in o?o.openReportDialog:e(ut))(e(n).account,e(n)))},null,8,["text","command"])],64))],64)):b("",!0)])]),default:h(()=>[p(ce,{content:o.$t("action.more"),color:"text-primary",hover:"text-primary","elk-group-hover":"bg-primary-light",icon:"i-ri:more-line","my--2":""},null,8,["content"])]),_:1},8,["eager-mount"])}}}),ln=["lang"],rn={key:1},un=r("div",{my2:"","h-px":"",border:"b base","bg-base":""},null,-1),cn={key:1,"text-red-4":""},dn=D({__name:"StatusBody",props:{status:{},newer:{},withAction:{type:Boolean,default:!0}},setup(l){const{translation:t}=Oe(l.status,Ve()),s=pt(()=>l.status.emojis),i=k(()=>l.status.content?vt(l.status.content,{emojis:s.value,mentions:"mentions"in l.status?l.status.mentions:void 0,markdown:!0,collapseMentionLink:!!("inReplyToId"in l.status&&l.status.inReplyToId),status:"id"in l.status?l.status:void 0,inReplyToStatus:l.newer}):null);return(d,n)=>{const c=ft;return a(),v("div",{class:I(["status-body",{"with-action":d.withAction}]),"whitespace-pre-wrap":"","break-words":"",relative:""},[d.status.content?(a(),v("span",{key:0,class:"content-rich line-compact",dir:"auto",lang:"language"in d.status&&d.status.language||void 0},[e(i)?(a(),g(ye(e(i)),{key:0})):b("",!0)],8,ln)):(a(),v("div",rn)),e(t).visible?(a(),v(N,{key:2},[un,e(t).success?(a(),g(c,{key:0,class:"line-compact",content:e(t).text,emojis:d.status.emojis},null,8,["content","emojis"])):(a(),v("div",cn," Error: "+B(e(t).error),1))],64)):b("",!0)],2)}}}),mn={key:0},pn=["disabled"],vn={key:0,block:"","animate-spin":"","preserve-3d":""},fn=r("span",{block:"","i-ri:loader-2-fill":""},null,-1),gn=[fn],bn={key:1,"i-ri:translate":""},yn=D({__name:"StatusTranslation",props:{status:{}},setup(l){const{toggle:t,translation:s,enabled:i}=Oe(l.status,Ve()),d=oe("hideTranslation"),n=k(()=>!d.value&&i&&l.status.content.trim().length),c=L(!1);async function u(){c.value=!0;try{await t()}finally{c.value=!1}}return($,w)=>e(n)?(a(),v("div",mn,[r("button",{"p-0":"",flex:"~ center","gap-2":"","text-sm":"",disabled:e(c),"disabled-bg-transparent":"","btn-text":"",class:"disabled-text-$c-text-btn-disabled-deeper",onClick:u},[e(c)?(a(),v("span",vn,gn)):(a(),v("div",bn)),E(" "+B(e(s).visible?$.$t("menu.show_untranslated"):$.$t("menu.translate_post")),1)],8,pn)])):b("",!0)}}),hn={flex:"","flex-col":"","w-full":"","items-stretch":"","gap-2":"",py3:"",dir:"auto",class:"poll-wrapper"},kn=["value","type"],$n={"btn-solid":"","mt-1":""},_n={flex:"","justify-between":"","pb-2":"","w-full":""},wn={"inline-flex":"","align-items":""},Cn={key:0,"ms-2":"","mt-1":"","inline-block":"","i-ri:checkbox-circle-line":""},Sn={"text-primary-active":""},An=r("div",{class:"bg-gray/40","rounded-l-sm":"","rounded-r-lg":"","h-5px":"","w-full":""},[r("div",{"bg-primary-active":"","h-full":"","min-w":"1%",class:"w-[var(--bar-width)]"})],-1),Bn={"text-sm":"",flex:"~ inline","gap-x-1":"","text-secondary":""},Rn=["datetime"],Tn=D({__name:"StatusPoll",props:{status:{}},setup(l){const t=gt({...l.status.poll});function s(A){return`${(100*A).toFixed(1).replace(/\.?0+$/,"")}%`}const i=ge(),d=ze(t.expiresAt,i),n=be(t.expiresAt),{formatPercentage:c}=bt(),{client:u}=he();async function $(A){const T=new FormData(A.target).getAll("choices").map(f=>+f);for(const[f,y]of t.options.entries())T.includes(f)&&(y.votesCount=(y.votesCount||0)+1);t.voted=!0,t.votesCount++,!t.votersCount&&t.votesCount?t.votesCount=t.votesCount+1:t.votersCount=(t.votersCount||0)+1,q({...l.status,poll:t},void 0,!0),await u.value.v1.polls.$select(t.id).votes.create({choices:T})}const w=k(()=>t.votersCount??t.votesCount??0);return(A,C)=>{const T=He,f=X;return a(),v("div",hn,[!e(t).voted&&!e(t).expired?(a(),v("form",{key:0,flex:"~ col gap3","accent-primary":"",onClick:C[0]||(C[0]=ee((...y)=>("noop"in A?A.noop:e(Q))&&("noop"in A?A.noop:e(Q))(...y),["stop"])),onSubmit:ee($,["prevent"])},[(a(!0),v(N,null,fe(e(t).options,(y,_)=>(a(),v("label",{key:_,flex:"~ gap2","items-center":""},[r("input",{name:"choices",value:_,type:e(t).multiple?"checkbox":"radio","cursor-pointer":""},null,8,kn),E(" "+B(y.title),1)]))),128)),r("button",$n,B(A.$t("action.vote")),1)],32)):(a(!0),v(N,{key:1},fe(e(t).options,(y,_)=>(a(),v("div",{key:_,"py-1":"",relative:"",style:yt({"--bar-width":s(e(w)===0?0:(y.votesCount??0)/e(w))})},[r("div",_n,[r("span",wn,[E(B(y.title)+" ",1),e(t).voted&&e(t).ownVotes?.includes(_)?(a(),v("span",Cn)):b("",!0)]),r("span",Sn,B(e(c)(e(w)>0?(y.votesCount||0)/e(w):0)),1)]),An],4))),128)),r("div",Bn,[p(T,{keypath:"status.poll.count",count:e(t).votesCount},null,8,["count"]),E(" · "),e(t).expiresAt?(a(),g(f,{key:0,content:e(n),class:"inline-block",placement:"right"},{default:h(()=>[r("time",{datetime:e(t).expiresAt},B(A.$t(e(t).expired?"status.poll.finished":"status.poll.ends",[e(d)])),9,Rn)]),_:1},8,["content"])):b("",!0)])])}}}),xn=D({__name:"StatusMedia",props:{status:{},fullSize:{type:Boolean},isPreview:{type:Boolean,default:!1}},setup(l){return(t,s)=>{const i=Mt;return a(),v("div",{class:I(["status-media-container",`status-media-container-${t.status.mediaAttachments.length}`])},[(a(!0),v(N,null,fe(t.status.mediaAttachments,d=>(a(),g(i,{key:d.id,attachment:d,attachments:t.status.mediaAttachments,"full-size":t.fullSize,"w-full":"","h-full":"","is-preview":t.isPreview},null,8,["attachment","attachments","full-size","is-preview"]))),128))],2)}}}),Dn={key:0},Nn={key:0,"h-80":"","cursor-pointer":"",relative:""},In={"p-3":"",absolute:"","w-full":"","h-full":"","z-100":"","rounded-lg":"",style:{background:"linear-gradient(black, rgba(0,0,0,0.5), transparent, transparent, rgba(0,0,0,0.20))"}},Pn={flex:"","gap-0.5":""},Mn={"flex-row":"","line-clamp-1":""},En={key:0},jn=r("span",{"flex-row":"","w-4":"","h-4":"","pointer-events-none":"","i-ri:arrow-right-up-line":""},null,-1),Ln={"font-bold":"","line-clamp-1":"","text-size-base":""},Un={"line-clamp-1":""},zn={flex:"","h-50":"","mt-1":"","justify-center":"","flex-items-center":""},Hn=r("span",{"text-light":"",flex:"","flex-col":"","gap-3":"","w-27":"","h-27":"","pointer-events-none":"","i-ri:play-circle-line":""},null,-1),Fn=[Hn],On={key:1},Vn=D({__name:"StatusEmbeddedMedia",props:{status:{}},setup(l){const t=k(()=>{if(!l.status.card?.html)return null;const d=ht(l.status.card?.html)?.children[0];return d?kt(d):null}),s=L(!0),i=L(l.status.card);return(d,n)=>{const c=J,u=jt;return e(i)?(a(),v("div",Dn,[e(s)?(a(),v("div",Nn,[r("div",In,[p(c,{flex:"","flex-col":"","gap-1":"","hover:underline":"","text-xs":"","text-light":"","font-light":"",target:"_blank",href:e(i)?.url},{default:h(()=>[r("div",Pn,[r("p",Mn,[E(B(e(i)?.providerName),1),e(i)?.authorName?(a(),v("span",En," • "+B(e(i)?.authorName),1)):b("",!0)]),jn]),r("p",Ln,B(e(i)?.title),1),r("p",Un,B(d.$t("status.embedded_warning")),1)]),_:1},8,["href"]),r("div",zn,[r("button",{absolute:"","bg-primary":"","opacity-85":"","rounded-full":"","hover:bg-primary-active":"","hover:opacity-95":"","transition-all":"","box-shadow-outline":"",onClick:n[0]||(n[0]=ee(()=>s.value=!e(s),["stop","prevent"]))},Fn)])]),e(i)?.image?(a(),g(u,{key:0,blurhash:e(i).blurhash,src:e(i).image,"w-full":"","h-full":"","object-cover":"","rounded-lg":""},null,8,["blurhash","src"])):b("",!0)])):(a(),v("div",On,[e(t)?(a(),g(ye(e(t)),{key:0,"rounded-lg":"","h-80":""})):b("",!0)]))])):b("",!0)}}}),Kn={key:0,flex:"","flex-col":"","items-start":""},Gn={class:"content-rich",p:"x-4 b-2.5","text-center":"","text-secondary":"","w-full":"",border:"~ base","border-0":"","border-b-dotted":"","border-b-3":"","mt-2":""},Wn=["mb"],qn=["bg","aria-expanded"],Jn={key:0,"i-ri:eye-line":""},Xn={key:1,"i-ri:eye-close-line":""},Yn=D({__name:"StatusSpoiler",props:{enabled:{type:Boolean},filter:{type:Boolean},isDM:{type:Boolean},sensitiveNonSpoiler:{type:Boolean}},setup(l){const t=l,s=k(()=>{const u=M.value?$t(M.value.account):!1,$=M.value?_t(M.value.account):!1;return!t.filter&&(t.sensitiveNonSpoiler&&$||!t.sensitiveNonSpoiler&&u)}),i=t.enabled||t.sensitiveNonSpoiler,d=L(s.value?!0:!i),n=wt(d);Ct(()=>{d.value=s.value?!0:!i});function c(){return t.sensitiveNonSpoiler?"status.spoiler_media_hidden":t.filter?"status.filter_show_anyway":"status.spoiler_show_more"}return(u,$)=>(a(),v(N,null,[e(i)?(a(),v("div",Kn,[r("div",Gn,[F(u.$slots,"spoiler")]),r("div",{flex:"~ gap-1 center","w-full":"",mb:u.isDM&&!e(d)?"4":"",mt:"-4.5"},[r("button",{"btn-text":"","px-2":"","py-1":"","rounded-lg":"",bg:u.isDM?"transparent":"base",flex:"~ center gap-2",class:I(e(d)?"":"filter-saturate-0 hover:filter-saturate-100"),"aria-expanded":e(d),onClick:$[0]||($[0]=w=>e(n)())},[e(d)?(a(),v("div",Jn)):(a(),v("div",Xn)),E(" "+B(e(d)?u.$t("status.spoiler_show_less"):u.$t(c())),1)],10,qn)],8,Wn)])):b("",!0),!e(i)||e(d)?F(u.$slots,"default",{key:1}):b("",!0)],64))}}),Zn={key:6},Qn=D({__name:"StatusContent",props:{status:{},newer:{},context:{},isPreview:{type:Boolean},inNotification:{type:Boolean}},setup(l){const t=k(()=>l.status.visibility==="direct"),s=k(()=>l.context==="details"),i=k(()=>l.status.filtered?.length?l.status.filtered[0]:null),d=k(()=>i.value?.filter),n=k(()=>d.value?.title),c=k(()=>l.status.account.id!==M.value?.account.id&&n&&l.context&&l.context!=="details"&&!!d.value?.context.includes(l.context)),u=k(()=>!!l.status.spoilerText&&l.status.spoilerText.trim().length>0),$=k(()=>u.value||l.status.sensitive&&!!l.status.mediaAttachments.length),w=k(()=>l.status.sensitive&&!l.status.spoilerText&&!!l.status.mediaAttachments.length),A=k(()=>M.value?St(M.value.account)&&(!!l.status.mediaAttachments.length||!!l.status.card?.html):!1),C=oe("experimentalEmbeddedMedia"),T=k(()=>l.status.card?.html&&C.value);return(f,y)=>{const _=dn,P=yn,j=Tn,z=xn,V=Et,S=Vn,O=Eo,K=Yn;return a(),v("div",{"space-y-3":"",class:I({"pt2 pb0.5 px3.5 bg-dm rounded-4 me--1":e(t),"ms--3.5 mt--1 ms--1":e(t)&&f.context!=="details"})},[!e(c)&&e(w)||e(A)?(a(),g(_,{key:0,status:f.status,newer:f.newer,"with-action":!e(s),class:I(e(s)?"text-xl":"")},null,8,["status","newer","with-action","class"])):b("",!0),p(K,{enabled:e($)||e(c),filter:e(c),"sensitive-non-spoiler":e(w)||e(A),"is-d-m":e(t)},Z({default:h(()=>[e(w)||e(A)?b("",!0):(a(),g(_,{key:0,status:f.status,newer:f.newer,"with-action":!e(s),class:I(e(s)?"text-xl":"")},null,8,["status","newer","with-action","class"])),p(P,{status:f.status},null,8,["status"]),f.status.poll?(a(),g(j,{key:1,status:f.status},null,8,["status"])):b("",!0),f.status.mediaAttachments?.length?(a(),g(z,{key:2,status:f.status,"is-preview":f.isPreview},null,8,["status","is-preview"])):b("",!0),f.status.card&&!e(T)?(a(),g(V,{key:3,card:f.status.card,"small-picture-only":f.status.mediaAttachments?.length>0},null,8,["card","small-picture-only"])):b("",!0),e(T)?(a(),g(S,{key:4,status:f.status},null,8,["status"])):b("",!0),f.status.reblog?(a(),g(O,{key:5,status:f.status.reblog,border:"~ rounded",actions:!1},null,8,["status"])):b("",!0),e(t)?(a(),v("div",Zn)):b("",!0)]),_:2},[e(u)?{name:"spoiler",fn:h(()=>[r("p",null,B(f.status.spoilerText),1)]),key:"0"}:e(n)?{name:"spoiler",fn:h(()=>[r("p",null,B(`${f.$t("status.filter_hidden_phrase")}: ${e(n)}`),1)]),key:"1"}:void 0]),1032,["enabled","filter","sensitive-non-spoiler","is-d-m"])],2)}}}),eo={flex:"","justify-between":"","items-center":"",class:"status-actions"},to={"flex-1":""},no={"flex-1":""},oo={"flex-1":""},so={"flex-none":""},ao=D({__name:"StatusActions",props:{status:{},details:{type:Boolean},command:{type:Boolean}},setup(l){const t=l,s=Ue("focus-editor",Q),{details:i,command:d}=t,n=te(),c=oe("useStarFavoriteIcon"),{status:u,isLoading:$,canReblog:w,toggleBookmark:A,toggleFavourite:C,toggleReblog:T}=Ge(t);function f(){ne()&&(i?s():At({status:u.value,focusReply:!0}))}return(y,_)=>{const P=He,j=Ke;return a(),v("div",eo,[r("div",to,[p(j,{content:y.$t("action.reply"),text:!("getPreferences"in y?y.getPreferences:e(U))(e(n),"hideReplyCount")&&e(u).repliesCount||"",color:"text-blue",hover:"text-blue","elk-group-hover":"bg-blue/10",icon:"i-ri:chat-1-line",command:e(d),onClick:f},Z({_:2},[e(u).repliesCount&&!("getPreferences"in y?y.getPreferences:e(U))(e(n),"hideReplyCount")?{name:"text",fn:h(()=>[p(P,{keypath:"action.reply_count",count:e(u).repliesCount},null,8,["count"])]),key:"0"}:void 0]),1032,["content","text","command"])]),r("div",no,[p(j,{content:y.$t(e(u).reblogged?"action.boosted":"action.boost"),text:!("getPreferences"in y?y.getPreferences:e(U))(e(n),"hideBoostCount")&&e(u).reblogsCount?e(u).reblogsCount:"",color:"text-green",hover:"text-green","elk-group-hover":"bg-green/10",icon:"i-ri:repeat-line","active-icon":"i-ri:repeat-fill","inactive-icon":"i-tabler:repeat-off",active:!!e(u).reblogged,disabled:e($).reblogged||!e(w),command:e(d),onClick:_[0]||(_[0]=z=>e(T)())},Z({_:2},[e(u).reblogsCount&&!("getPreferences"in y?y.getPreferences:e(U))(e(n),"hideBoostCount")?{name:"text",fn:h(()=>[p(P,{keypath:"action.boost_count",count:e(u).reblogsCount},null,8,["count"])]),key:"0"}:void 0]),1032,["content","text","active","disabled","command"])]),r("div",oo,[p(j,{content:y.$t(e(u).favourited?"action.favourited":"action.favourite"),text:!("getPreferences"in y?y.getPreferences:e(U))(e(n),"hideFavoriteCount")&&e(u).favouritesCount?e(u).favouritesCount:"",color:e(c)?"text-yellow":"text-rose",hover:e(c)?"text-yellow":"text-rose","elk-group-hover":e(c)?"bg-yellow/10":"bg-rose/10",icon:e(c)?"i-ri:star-line":"i-ri:heart-3-line","active-icon":e(c)?"i-ri:star-fill":"i-ri:heart-3-fill",active:!!e(u).favourited,disabled:e($).favourited,command:e(d),onClick:_[1]||(_[1]=z=>e(C)())},Z({_:2},[e(u).favouritesCount&&!("getPreferences"in y?y.getPreferences:e(U))(e(n),"hideFavoriteCount")?{name:"text",fn:h(()=>[p(P,{keypath:"action.favourite_count",count:e(u).favouritesCount},null,8,["count"])]),key:"0"}:void 0]),1032,["content","text","color","hover","elk-group-hover","icon","active-icon","active","disabled","command"])]),r("div",so,[p(j,{content:y.$t(e(u).bookmarked?"action.bookmarked":"action.bookmark"),color:e(c)?"text-rose":"text-yellow",hover:e(c)?"text-rose":"text-yellow","elk-group-hover":e(c)?"bg-rose/10":"bg-yellow/10",icon:"i-ri:bookmark-line","active-icon":"i-ri:bookmark-fill",active:!!e(u).bookmarked,disabled:e($).bookmarked,command:e(d),onClick:_[2]||(_[2]=z=>e(A)())},null,8,["content","color","hover","elk-group-hover","active","disabled","command"])])])}}}),io=["id","lang"],lo=D({__name:"StatusLink",props:{status:{},hover:{type:Boolean}},setup(l){const t=l,s=L(),i=ke(),d=k(()=>$e(t.status));function n(u){const w=u.composedPath().find(T=>["A","BUTTON","IMG","VIDEO"].includes(T.tagName?.toUpperCase())),A=window.getSelection()?.toString(),C=w?.parentElement?.classList.contains("custom-emoji");(!w&&!A||C)&&c(u)}function c(u){u.metaKey||u.ctrlKey?window.open(d.value.href):(q(t.status),i.push(d.value))}return(u,$)=>(a(),v("div",{id:`status-${u.status.id}`,ref_key:"el",ref:s,relative:"",flex:"~ col gap1",p:"b-2 is-3 ie-4",class:I({"hover:bg-active":u.hover}),tabindex:"0","focus:outline-none":"","focus-visible:ring":"2 primary inset","aria-roledescription":"status-card",lang:u.status.language??void 0,onClick:n,onKeydown:Bt(n,["enter"])},[F(u.$slots,"default")],42,io))}}),ro=["h"],uo={flex:"~ col gap-1","items-center":"",pos:"absolute top-0 inset-is-0",w:"77px","z--1":""},co=r("div",{w:"1px",h:"0.5",border:"x base","mt-3":""},null,-1),mo=r("div",{w:"1px",h:"0.5",border:"x base"},null,-1),po=r("div",{w:"1px",h:"0.5",border:"x base"},null,-1),vo=r("div",{w:"1px","h-10":"",border:"x base"},null,-1),fo={flex:"~ col","justify-between":""},go={key:0,flex:"~","items-center":"",p:"t-1 b-0.5 x-1px",relative:"","text-secondary":"","ws-nowrap":""},bo=r("div",{"i-ri:repeat-fill":"","me-46px":"","text-green":"","w-16px":"","h-16px":"",class:"status-boosted"},null,-1),yo={absolute:"","top-1":"","ms-24px":"","w-32px":"","h-32px":"","rounded-full":""},ho={key:0,flex:"~col 1","min-w-0":""},ko={italic:""},$o=r("div",{"i-ri:eye-line":""},null,-1),_o={relative:""},wo={key:0,absolute:"",flex:"","items-center":"","justify-center":"","top--6px":"","px-2px":"","py-3px":"","rounded-full":"","bg-base":""},Co=r("div",{"i-ri:repeat-fill":"","text-green":"","w-16px":"","h-16px":""},null,-1),So=[Co],Ao={key:1,"w-full":"","h-full":"",flex:"","mt--3px":"","justify-center":""},Bo=r("div",{"w-1px":"",border:"x base","mb-9":""},null,-1),Ro=[Bo],To={flex:"~ col 1","min-w-0":""},xo={flex:"","items-center":"","space-x-1":""},Do=r("div",{"flex-auto":""},null,-1),No={"text-sm":"","text-secondary":"",flex:"~ row nowrap","hover:underline":"","whitespace-nowrap":""},Io={flex:"~ gap1","items-center":""},Po={flex:""},Mo=["datetime"],Eo=D({__name:"StatusCard",props:{status:{},actions:{type:Boolean,default:!0},context:{},hover:{type:Boolean},inNotification:{type:Boolean},isPreview:{type:Boolean},older:{},newer:{},hasOlder:{type:Boolean},hasNewer:{type:Boolean},main:{}},setup(l){const t=l,s=te(),i=k(()=>t.status.reblog&&(!t.status.content||t.status.content===t.status.reblog.content)?t.status.reblog:t.status),d=k(()=>t.hasNewer||!!i.value.inReplyToId&&(i.value.inReplyToId===t.newer?.id||i.value.inReplyToId===t.newer?.reblog?.id)),n=k(()=>t.hasOlder||i.value.id===t.older?.inReplyToId||i.value.id===t.older?.reblog?.inReplyToId),c=k(()=>t.main&&t.main.id===i.value.inReplyToId),u=k(()=>t.status.reblog?t.status.account:null),$=k(()=>$e(i.value)),w=ke();function A(S){S.metaKey||S.ctrlKey?window.open($.value.href):(q(i.value),w.push($.value))}const C=be(i.value.createdAt),T=ge(!0),f=ze(()=>i.value.createdAt,T),y=k(()=>i.value.inReplyToAccountId===i.value.account.id),_=k(()=>u.value?.id===i.value.account.id),P=k(()=>i.value.visibility==="direct"),j=k(()=>t.newer&&!d.value),z=k(()=>!c.value&&!d.value),V=L(!1);return(S,O)=>{const K=Ht,se=Rt,G=J,W=Tt,ae=Pe,ie=xt,le=Ft,re=Dt,ue=Nt,o=Vt,m=X,ce=en,R=an,de=Qn,me=ao,x=lo;return a(),g(x,{status:e(i),hover:S.hover},{default:h(()=>[r("div",{h:e(j)?"1px":"0","w-auto":"","bg-border":"","mb-1":""},null,8,ro),F(S.$slots,"meta",{},()=>[e(i).inReplyToAccountId?(a(),v(N,{key:0},[e(z)?(a(),g(K,{key:0,m:"is-5",p:"t-1 is-5",status:e(i),"is-self-reply":e(y),class:I(S.inNotification?"text-secondary-light":"")},null,8,["status","is-self-reply","class"])):b("",!0),r("div",uo,[e(z)?(a(),v(N,{key:0},[co,mo,po],64)):b("",!0),vo])],64)):b("",!0),r("div",fo,[e(u)&&!e(_)?(a(),v("div",go,[bo,r("div",yo,[p(W,{account:e(u)},{default:h(()=>[p(G,{to:("getAccountRoute"in S?S.getAccountRoute:e(ve))(e(u))},{default:h(()=>[p(se,{account:e(u)},null,8,["account"])]),_:1},8,["to"])]),_:1},8,["account"])]),p(ae,{"font-bold":"",account:e(u),avatar:!1,"text-sm":""},null,8,["account"])])):b("",!0)])]),r("div",{flex:"","gap-3":"",class:I({"text-secondary":S.inNotification})},[e(i).account.suspended&&!e(V)?(a(),v("div",ho,[r("p",ko,B(S.$t("status.account.suspended_message")),1),r("div",null,[r("button",{"p-0":"",flex:"~ center","gap-2":"","text-sm":"","btn-text":"",onClick:O[0]||(O[0]=_e=>V.value=!0)},[$o,r("span",null,B(S.$t("status.account.suspended_show")),1)])])])):(a(),v(N,{key:1},[r("div",_o,[e(_)?(a(),v("div",wo,So)):b("",!0),p(W,{account:e(i).account},{default:h(()=>[p(G,{to:("getAccountRoute"in S?S.getAccountRoute:e(ve))(e(i).account),"rounded-full":""},{default:h(()=>[p(ie,{account:e(i).account},null,8,["account"])]),_:1},8,["to"])]),_:1},8,["account"]),e(n)?(a(),v("div",Ao,Ro)):b("",!0)]),r("div",To,[r("div",xo,[p(W,{account:e(i).account},{default:h(()=>[p(le,{account:e(i).account},null,8,["account"])]),_:1},8,["account"]),Do,Ne(r("div",No,[e(i).account.locked?(a(),g(re,{key:0,"me-2":""})):b("",!0),e(i).account.bot?(a(),g(ue,{key:1,"me-2":""})):b("",!0),r("div",Io,[e(i).visibility!=="public"?(a(),g(o,{key:0,status:e(i)},null,8,["status"])):b("",!0),r("div",Po,[p(m,{content:e(C),"no-auto-focus":""},{default:h(()=>[p(G,{title:e(i).createdAt,href:e($).href,onClick:O[1]||(O[1]=ee(_e=>A(_e),["prevent"]))},{default:h(()=>[r("time",{"text-sm":"","ws-nowrap":"","hover:underline":"",datetime:e(i).createdAt},B(e(f)),9,Mo)]),_:1},8,["title","href"])]),_:1},8,["content"]),p(ce,{status:e(i),inline:""},null,8,["status"])])])],512),[[Ie,!("getPreferences"in S?S.getPreferences:e(U))(e(s),"zenMode")]]),S.actions!==!1?(a(),g(R,{key:0,status:e(i),"me--2":""},null,8,["status"])):b("",!0)]),p(de,{status:e(i),newer:S.newer,context:S.context,"is-preview":S.isPreview,"in-notification":S.inNotification,mb2:"",class:I({"mt-2 mb1":e(P)})},null,8,["status","newer","context","is-preview","in-notification","class"]),S.actions!==!1?Ne((a(),g(me,{key:0,status:e(i)},null,8,["status"])),[[Ie,!("getPreferences"in S?S.getPreferences:e(U))(e(s),"zenMode")]]):b("",!0)])],64))],2)]),_:3},8,["status","hover"])}}});export{an as _,Qn as a,en as b,Vt as c,ao as d,Eo as e,dn as f,xn as g,Tn as h,lo as i,Yn as j};
