import{v as y,ba as E,cm as w,a as d,D as b,a1 as S}from"./CMcu4vOi.js";var U=Object.defineProperty,I=Object.defineProperties,R=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,O=(e,r,t)=>r in e?U(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,v=(e,r)=>{for(var t in r||(r={}))C.call(r,t)&&O(e,t,r[t]);if(_)for(var t of _(r))T.call(r,t)&&O(e,t,r[t]);return e},q=(e,r)=>I(e,R(r)),z=(e,r,t)=>new Promise((n,o)=>{var a=s=>{try{u(t.next(s))}catch(c){o(c)}},i=s=>{try{u(t.throw(s))}catch(c){o(c)}},u=s=>s.done?n(s.value):Promise.resolve(s.value).then(a,i);u((t=t.apply(e,r)).next())}),A=e=>typeof e=="function";function p(e,r){return Object.prototype.hasOwnProperty.call(e,r)}var N=e=>e==null,P=e=>e instanceof Date,j=e=>typeof e=="object",h=e=>N(e)||!j(e),V=e=>Promise.resolve(e)===e,x=e=>Object.keys(e).length===0;function B(e,r){return D(e,r)}function D(e,r,t=new WeakSet){if(h(e)||h(r))return{equal:e===r,pointersEqual:!1};let n=e===r;if(n||t.has(e))return{equal:n,pointersEqual:n};if(t.add(e),P(e)&&P(r))return{equal:e.getTime()===r.getTime(),pointersEqual:!1};const o=Object.keys(e),a=Object.keys(r);if(o.length!==a.length)return{equal:!1,pointersEqual:!1};for(const i of o){const u=e[i];if(!a.includes(i))return{equal:!1,pointersEqual:n};const s=r[i],c=D(u,s,t);if(!c.equal)return c;n||(n=c.pointersEqual)}return t.delete(e),{equal:!0,pointersEqual:n}}function H(e,r,t){const n=y(0),o=y(0),a=b(e,()=>{o.value++},q(v({},t),{flush:"sync"})),i=b(e,(...c)=>{const f=n.value>0&&n.value===o.value;n.value=0,o.value=0,f||r(...c)},t);return{ignoreUpdates:c=>{const f=o.value;c();const l=o.value-f;n.value+=l},ignorePrevAsyncUpdates:()=>{n.value=o.value},stop:()=>{a(),i()}}}function L(e,r,t,n,o,a){for(const i in r){if(!p(r,i))continue;const u=p(a,i)?a[i]:void 0;e[i]=E(v({message:n,isError:!1,isDirty:d(()=>!B(t.value[i],r[i]).equal)},M(i,e,r,n,o,u)))}}function M(e,r,t,n,o,a){function i(m,g=!0){r[e].message=m,r[e].isError=g}function u(){if(!a)return;const{message:m,valid:g}=a.validate(t[e],{fullResult:!0});i(m,!g)}let s=null;const c=()=>{!a||o||s||(s=S(u))},{ignoreUpdates:f}=H(()=>t[e],c,{deep:j(t[e])});function l(){s&&(s(),s=null),i(n,!1)}function F(){return u(),!r[e].isError}return{verify:F,setError:i,clearError:l,init:c,_ignoreUpdate:f}}function W(e,r){return d(()=>{const t={},n=Object.keys(e);for(const o of n)r[o].isDirty&&p(e,o)&&(t[o]=e[o]);return w(t)})}function G(e){return d(()=>{var r;const t=Object.keys(e);for(const n of t)if((r=e[n])!=null&&r.isError)return!0;return!1})}function J(e){return d(()=>!x(e.value))}var k=(e,...r)=>e(...r);function K(e,r,t){const{enableVerify:n=!0}=t??{},{verify:o}=e,a=y(!1);return{submitting:a,submit:()=>{if(n&&!o())return;const u=r(e);return V(u)?k(()=>z(this,null,function*(){a.value=!0;try{return yield u}finally{a.value=!1}})):u}}}function Q(e){return(...r)=>K(e(),...r)}function X(e,r){const t={};for(const n in e){let o=function(i,u={}){const{fullResult:s}=u;for(const c of a||[]){const f=c(i);if(!f||typeof f=="string")return s?{valid:!1,message:f||r}:!1}return s?{valid:!0,message:r}:!0};const a=k(()=>{const i=e?.[n];return A(i)?[i]:i});t[n]={validate:o}}return t}var Y={defaultMessage:"",lazy:!1};function ee(e){const r=Object.assign({},Y,e),{form:t,rule:n,defaultMessage:o,lazy:a}=r,i=y(t()),u=E(t()),s=X(n,o),c=E({});L(c,u,i,o,a,s);const f=W(u,c),l=v({form:u,status:w(c),dirtyFields:f,isDirty:J(f),isError:G(c)},Z(t,i,u,c));return q(v({},l),{rule:s,submitter:Q(()=>l)})}function Z(e,r,t,n){const o=()=>{let s=!0;return Object.keys(n).forEach(c=>{s=s&&n[c].verify()}),s};return{verify:o,clearErrors:()=>{Object.keys(n).forEach(s=>{n[s].clearError()})},reset:(...s)=>{r.value=e();const c=e(),f=l=>s.length===0||s.includes(l);for(const l in t)f(l)&&p(t,l)&&(p(c,l)?(n[l]._ignoreUpdate(()=>{t[l]=c[l]}),n[l].clearError()):delete t[l])},onSubmit:s=>o()?s():null}}export{ee as u};
