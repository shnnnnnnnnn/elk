import{_ as J,a as K,b as O,c as Q,d as X,e as Y}from"./B5y2QTf5.js";import{d as R,a as N,u as Z,b as tt,e as et,g as st,r as nt,o as s,c as f,f as i,h as t,w as l,i as at,j as c,t as h,k as _,l as V,m as o,_ as ot,n as rt,p as L,q as M,s as it,v as B,x as C,y as T,z as ct,A as ut,B as F,C as lt,D as dt,E as _t,F as mt,G as pt,H as ft,I as vt,J as H,K as yt}from"./CMcu4vOi.js";import{_ as ht}from"./-SIb_O-z.js";import{_ as bt}from"./Bbd1R54p.js";import{s as $t,a as gt,_ as kt,b as wt}from"./Cy5WKwqU.js";import{u as I}from"./Cs8xWohE.js";import"./weTs8tLg.js";import"./CziPTEgh.js";import"./BwHuf7fG.js";import"./VKdB9Mfh.js";import"./DDd3r5-x.js";import"./Brx9_43Z.js";import"./sfWYJY5J.js";import"./CfB6UbSh.js";import"./CjVkB9VF.js";import"./WqbmNLH1.js";import"./BsDGj7hD.js";import"./Bo2XathJ.js";import"./BBra7vxC.js";import"./C1NZMy0l.js";const xt=["id","lang"],St={flex:"~ gap-1","items-center":"","text-secondary":"","text-sm":""},At={flex:""},Ct={ms1:"","font-bold":"","cursor-pointer":""},Nt=c("div",{"aria-hidden":"true"}," Â· ",-1),Dt={key:0,"aria-hidden":"true"},Rt={key:1},Et={key:2},Bt={border:"t base","py-2":""},Tt=R({__name:"StatusDetails",props:{status:{},newer:{},command:{type:Boolean},actions:{type:Boolean,default:!0}},emits:["refetchStatus"],setup(b){const r=b,e=N(()=>r.status.reblog&&r.status.reblog?r.status.reblog:r.status),m=Z(e.value.createdAt),{t:n}=tt();return et({title:()=>`${st(e.value.account)} ${n("common.in")} ${n("app_name")}: "${nt(e.value.content)||""}"`}),(a,$)=>{const D=J,d=ot,p=rt,g=L,w=K,k=O,x=Q,S=X;return s(),f("div",{id:`status-${t(e).id}`,flex:"","flex-col":"","gap-2":"",pt2:"",pb1:"","ps-3":"","pe-4":"",relative:"",lang:t(e).language??void 0,"aria-roledescription":"status-details"},[i(D,{status:t(e),details:!0,absolute:"","inset-ie-2":"","top-2":"",onAfterEdit:$[0]||($[0]=v=>a.$emit("refetchStatus"))},null,8,["status"]),i(g,{to:("getAccountRoute"in a?a.getAccountRoute:t(at))(t(e).account),"rounded-full":"","hover:bg-active":"","transition-100":"",pe5:"","me-a":""},{default:l(()=>[i(p,{account:t(e).account},{default:l(()=>[i(d,{account:t(e).account},null,8,["account"])]),_:1},8,["account"])]),_:1},8,["to"]),i(w,{status:t(e),newer:a.newer,context:"details"},null,8,["status","newer"]),c("div",St,[c("div",At,[c("div",null,h(t(m)),1),i(k,{status:t(e),inline:!1},{default:l(()=>[c("span",Ct,h(a.$t("state.edited")),1)]),_:1},8,["status"])]),Nt,i(x,{status:t(e)},null,8,["status"]),t(e).application?.name?(s(),f("div",Dt," Â· ")):_("",!0),t(e).application?.website&&t(e).application.name?(s(),f("div",Rt,[i(g,{to:t(e).application.website},{default:l(()=>[V(h(t(e).application.name),1)]),_:1},8,["to"])])):t(e).application?.name?(s(),f("div",Et,h(t(e).application?.name),1)):_("",!0)]),c("div",Bt,[a.actions?(s(),o(S,{key:0,status:t(e),details:"",command:a.command},null,8,["status","command"])):_("",!0)])],8,xt)}}}),Ft={flex:"~ col center gap2"},Ht={"btn-solid":"",flex:"~ center gap-2","text-sm":"",px2:"",py1:""},It=c("div",{"i-ri:arrow-right-up-line":""},null,-1),Vt=R({__name:"StatusNotFound",props:{account:{},status:{}},setup(b){const r=N(()=>{const[e,m]=b.account.split("@"),n=m||M.value?.server;return n?`https://${n}/@${e}/${b.status}`:null});return(e,m)=>{const n=L,a=bt;return s(),o(a,null,{default:l(()=>[c("div",Ft,[c("div",null,h(e.$t("error.status_not_found")),1),t(r)?(s(),o(n,{key:0,to:t(r),external:"",target:"_blank"},{default:l(()=>[c("button",Ht,[It,V(" "+h(e.$t("status.try_original_site")),1)])]),_:1},8,["to"])):_("",!0)])]),_:1})}}}),Lt={key:0,"xl:mt-4":"",mb:"50vh",border:"b base"},oe=R({__name:"[status]",setup(b){const r=it(),e=N(()=>r.params.status),m=B(null),{data:n,pending:a,refresh:$}=I(`status:${e.value}`,()=>ct(e.value,!0),{watch:[C],immediate:C.value,default:()=>T()}),{client:D}=ut(),{data:d,pending:p,refresh:g}=I(`context:${e.value}`,async()=>D.value.v1.statuses.$select(e.value).context.fetch(),{watch:[C],immediate:C.value,lazy:!0,default:()=>T()});p&&F(p,w),a&&F(a,w);async function w(){await ft();const v=vt(m);v&&v.scrollIntoView(!0)}const k=B();function x(){return k.value?.focusEditor?.()}lt("focus-editor",x),dt(k,()=>{window.history.state.focusReply&&x()});const S=N(()=>n.value?_t(n.value):null);return mt(()=>{$(),g()}),(v,A)=>{const E=Y,U=Tt,W=ht,z=Vt,P=kt,j=wt,q=pt;return s(),o(q,{back:""},{default:l(()=>[t(a)?(s(),o(P,{key:1,border:"b base"})):(s(),f(H,{key:0},[t(n)?(s(),f("div",Lt,[t(p)?_("",!0):(s(!0),f(H,{key:0},yt(t(d)?.ancestors,(u,y)=>(s(),o(E,{key:u.id,status:u,actions:u.visibility!=="direct",context:"account","has-older":!0,newer:t(d)?.ancestors[y-1]},null,8,["status","actions","newer"]))),128)),i(U,{ref_key:"main",ref:m,status:t(n),newer:t(d)?.ancestors.at(-1),command:"",style:{"scroll-margin-top":"60px"},onRefetchStatus:A[0]||(A[0]=u=>t($)())},null,8,["status","newer"]),("currentUser"in v?v.currentUser:t(M))?(s(),o(W,{key:1,ref_key:"publishWidget",ref:k,border:"y base","draft-key":t(S).key,initial:t(S).draft,onPublished:A[1]||(A[1]=u=>t(g)())},null,8,["draft-key","initial"])):_("",!0),t(p)?_("",!0):(s(),o(t($t),{key:2,items:t(d)?.descendants||[],"min-item-size":200,buffer:800,"key-field":"id","page-mode":""},{default:l(({item:u,index:y,active:G})=>[i(t(gt),{item:u,active:G},{default:l(()=>[(s(),o(E,{key:u.id,status:u,context:"account",older:t(d)?.descendants[y+1],newer:y>0?t(d)?.descendants[y-1]:t(n),"has-newer":y===0,main:t(n)},null,8,["status","older","newer","has-newer","main"]))]),_:2},1032,["item","active"])]),_:1},8,["items"]))])):(s(),o(z,{key:1,account:t(r).params.account,status:t(e)},null,8,["account","status"]))],64)),t(a)||t(p)?(s(),o(j,{key:2})):_("",!0)]),_:1})}}});export{oe as default};
