import{d as H,az as Z,aA as ee,b as K,ap as z,v as u,H as p,ar as q,o as n,c as m,j as e,h as t,m as $,w as i,k as L,a4 as A,a5 as G,aE as I,l as J,t as b,J as F,aF as D,f as w,$ as P,X as te,a0 as X,p as O,e as oe,a as se,G as ne,ao as ie,a6 as re}from"./CMcu4vOi.js";import{_ as Q}from"./CfB6UbSh.js";import{u as ae}from"./BDljutRG.js";import{c as le}from"./Cy5WKwqU.js";const de=["aria-describedby"],ce={key:0,"bg-base":"",border:"~ base",h10:"",m2:"","ps-1":"","pe-4":"","rounded-3":"","w-full":"",flex:"~ row","items-center":"",relative:"","focus-within:box-shadow-outline":"","gap-3":""},ue=e("span",{block:"","text-current":"","i-ri:close-fill":""},null,-1),pe=[ue],fe={mr4:"",flex:"",gap2:""},_e=["disabled"],me={key:0,"aria-hidden":"true",block:"",animate:"","animate-spin":"","preserve-3d":"",class:"rtl-flip"},be=e("span",{block:"","i-ri:loader-2-fill":"","aria-hidden":"true"},null,-1),ve=[be],he={key:1,block:"","text-current":"","i-ri:save-2-fill":"",class:"rtl-flip"},ye=e("span",{block:"","text-current":"","i-ri:edit-2-line":"",class:"rtl-flip"},null,-1),$e=[ye],ge=["disabled"],ke={key:0,"aria-hidden":"true",block:"",animate:"","animate-spin":"","preserve-3d":"",class:"rtl-flip"},xe=e("span",{block:"","i-ri:loader-2-fill":"","aria-hidden":"true"},null,-1),we=[xe],Ce={key:1,block:"","text-current":"","i-ri:delete-bin-2-line":"",class:"rtl-flip"},Ee=["id"],Ve={flex:"","items-center":"","gap-x-2":"","font-bold":""},Me=e("div",{"aria-hidden":"true","i-ri:error-warning-fill":""},null,-1),Re=["aria-label"],Te=e("span",{"aria-hidden":"true",w:"1.75em",h:"1.75em","i-ri:close-line":""},null,-1),Be=[Te],Le={"ps-2":"","sm:ps-1":""},De={flex:"~ col sm:row","gap-y-1":"","sm:gap-x-2":""},Ne={"sr-only":""},je=H({__name:"ListEntry",props:{modelValue:{required:!0},modelModifiers:{}},emits:Z(["listUpdated","listRemoved"],["update:modelValue"]),setup(U,{emit:V}){const M=V,a=ee(U,"modelValue"),{t:f}=K(),g=z(),{form:r,isDirty:h,submitter:v,reset:R}=ae({form:()=>({...a.value})}),l=u(!1),_=u(!1),d=u(void 0),k=u(),o=u(),y=u();async function N(){l.value=!0,d.value=void 0,await p(),k.value?.focus()}async function x(){l.value=!1,d.value=void 0,R(),await p(),o.value?.focus()}const{submit:T,submitting:B}=v(async()=>{try{a.value=await g.v1.lists.$select(r.id).update({title:r.title}),x()}catch(s){console.error(s),d.value=s.message,await p(),k.value?.focus()}});async function j(){if(_.value)return;const s=await te({title:f("confirm.delete_list.title"),description:f("confirm.delete_list.description",[a.value.title]),confirm:f("confirm.delete_list.confirm"),cancel:f("confirm.delete_list.cancel")});if(_.value=!0,d.value=void 0,await p(),s.choice==="confirm"){await p();try{await g.v1.lists.$select(a.value.id).remove(),M("listRemoved",a.value.id)}catch(c){console.error(c),d.value=c.message,await p(),y.value?.focus()}finally{_.value=!1}}else _.value=!1}async function S(){d.value=void 0,await p(),l.value?k.value?.focus():y.value?.focus()}return q(x),(s,c)=>{const C=X,W=O,Y=Q;return n(),m(F,null,[e("form",{"hover:bg-active":"",flex:"","justify-between":"","items-center":"","gap-x-2":"","aria-describedby":t(d)?`action-list-error-${a.value.id}`:void 0,class:P(t(d)?"border border-base border-rounded rounded-be-is-0 rounded-be-ie-0 border-b-unset border-$c-danger-active":null),onSubmit:c[3]||(c[3]=D((...E)=>t(T)&&t(T)(...E),["prevent"]))},[t(l)?(n(),m("div",ce,[t(l)?(n(),$(C,{key:0,content:s.$t("list.cancel_edit"),"no-auto-focus":""},{default:i(()=>[e("button",{type:"button","rounded-full":"","text-sm":"",p2:"","transition-colors":"","hover:text-primary":"",onClick:c[0]||(c[0]=E=>x())},pe)]),_:1},8,["content"])):L("",!0),A(e("input",{ref_key:"input",ref:k,"onUpdate:modelValue":c[1]||(c[1]=E=>t(r).title=E),"rounded-3":"","w-full":"","bg-transparent":"",outline:"focus:none","pe-4":"",pb:"1px","flex-1":"","placeholder-text-secondary":"",onKeydown:c[2]||(c[2]=I(E=>x(),["esc"]))},null,544),[[G,t(r).title]])])):(n(),$(W,{key:1,to:`list/${a.value.id}`,block:"",grow:"",p4:""},{default:i(()=>[J(b(t(r).title),1)]),_:1},8,["to"])),e("div",fe,[t(l)?(n(),$(C,{key:0,content:s.$t("list.save"),"no-auto-focus":""},{default:i(()=>[e("button",{type:"submit","text-sm":"",p2:"","border-1":"","transition-colors":"","border-dark":"","hover:text-primary":"","btn-action-icon":"",disabled:t(_)||!t(h)||t(B)},[t(l)?(n(),m(F,{key:0},[t(B)?(n(),m("span",me,ve)):(n(),m("span",he))],64)):L("",!0)],8,_e)]),_:1},8,["content"])):(n(),$(C,{key:1,content:s.$t("list.edit"),"no-auto-focus":""},{default:i(()=>[e("button",{ref_key:"editBtn",ref:o,type:"button","text-sm":"",p2:"","border-1":"","transition-colors":"","border-dark":"","hover:text-primary":"","btn-action-icon":"",onClick:D(N,["prevent"])},$e,512)]),_:1},8,["content"])),w(C,{content:s.$t("list.delete"),"no-auto-focus":""},{default:i(()=>[e("button",{type:"button","text-sm":"",p2:"","border-1":"","transition-colors":"","border-dark":"","hover:text-primary":"","btn-action-icon":"",disabled:t(l),onClick:D(j,["prevent"])},[t(_)?(n(),m("span",ke,we)):(n(),m("span",Ce))],8,ge)]),_:1},8,["content"])])],42,de),t(d)?(n(),$(Y,{key:0,id:`action-list-error-${a.value.id}`,"described-by":`action-list-failed-${a.value.id}`,class:"rounded-bs-is-0 rounded-bs-ie-0 border-t-dashed m-b-2"},{default:i(()=>[e("header",{id:`action-list-failed-${a.value.id}`,flex:"","justify-between":""},[e("div",Ve,[Me,e("p",null,b(s.$t(`list.${t(l)?"edit_error":"delete_error"}`)),1)]),w(C,{placement:"bottom",content:s.$t("list.clear_error"),"no-auto-focus":""},{default:i(()=>[e("button",{flex:"","rounded-4":"",p1:"","hover:bg-active":"","cursor-pointer":"","transition-100":"","aria-label":s.$t("list.clear_error"),onClick:S},Be,8,Re)]),_:1},8,["content"])],8,Ee),e("ol",Le,[e("li",De,[e("strong",Ne,b(s.$t("list.error_prefix")),1),e("span",null,b(t(d)),1)])])]),_:1},8,["id","described-by"])):L("",!0)],64)}}}),Se=e("div",{"i-ri:list-check":""},null,-1),Ue={"text-lg":"","font-bold":""},Fe=["aria-describedby"],He={"bg-base":"",border:"~ base","flex-1":"",h10:"","ps-1":"","pe-4":"","rounded-2":"","w-full":"",flex:"~ row","items-center":"",relative:"","focus-within:box-shadow-outline":"","gap-3":""},Ke=["placeholder"],ze={flex:"~ col","gap-y-4":"","gap-x-2":"",sm:"~ justify-between flex-row"},qe=["disabled"],Ae={key:0,"aria-hidden":"true",block:"",animate:"","animate-spin":"","preserve-3d":"",class:"rtl-flip"},Ge=e("span",{block:"","i-ri:loader-2-fill":"","aria-hidden":"true"},null,-1),Ie=[Ge],Je={key:1,"aria-hidden":"true",block:"","i-material-symbols:playlist-add-rounded":"",class:"rtl-flip"},Pe={id:"create-list-failed",flex:"","justify-between":""},Xe={flex:"","items-center":"","gap-x-2":"","font-bold":""},Oe=e("div",{"aria-hidden":"true","i-ri:error-warning-fill":""},null,-1),Qe=["aria-label"],We=e("span",{"aria-hidden":"true",w:"1.75em",h:"1.75em","i-ri:close-line":""},null,-1),Ye=[We],Ze={"ps-2":"","sm:ps-1":""},et={flex:"~ col sm:row","gap-y-1":"","sm:gap-x-2":""},tt={"sr-only":""},rt=H({__name:"lists",setup(U){const{t:V}=K(),M=z(),a=M.v1.lists.list();oe({title:()=>V("nav.lists")});const f=u(),g=u(),r=u(void 0),h=u(!1),v=u(""),R=se(()=>v.value.length>0);async function l(){if(!(h.value||!R.value)){h.value=!0,r.value=void 0,await p();try{const o=await M.v1.lists.create({title:v.value});f.value?.createEntry(o),v.value=""}catch(o){console.error(o),r.value=o.message,p(()=>{g.value?.focus()})}finally{h.value=!1}}}function _(o){r.value=void 0,o&&p(()=>{g.value?.focus()})}function d(o){f.value?.updateEntry(o)}function k(o){f.value?.removeEntry(o)}return q(()=>_(!1)),(o,y)=>{const N=O,x=je,T=X,B=Q,j=le,S=ne;return n(),$(S,null,{title:i(()=>[w(N,{to:"/lists","timeline-title-style":"",flex:"","items-center":"","gap-2":"",onClick:o.$scrollToTop},{default:i(()=>[Se,e("span",Ue,b(t(V)("nav.lists")),1)]),_:1},8,["onClick"])]),default:i(()=>[ie(o.$slots,"default",{},()=>[w(j,{ref_key:"paginatorRef",ref:f,paginator:t(a)},{default:i(({item:s})=>[w(x,{"model-value":s,"onUpdate:modelValue":d,onListRemoved:k},null,8,["model-value"])]),done:i(()=>[e("form",{border:"t base","p-4":"","w-full":"",flex:"~ wrap",relative:"","gap-3":"","aria-describedby":t(r)?"create-list-error":void 0,class:P(t(r)?"border border-base border-rounded rounded-be-is-0 rounded-be-ie-0 border-b-unset border-$c-danger-active":null),onSubmit:D(l,["prevent"])},[e("div",He,[A(e("input",{ref_key:"inputRef",ref:g,"onUpdate:modelValue":y[0]||(y[0]=s=>re(v)?v.value=s:null),"bg-transparent":"",outline:"focus:none","px-4":"",pb:"1px","flex-1":"","placeholder-text-secondary":"",placeholder:o.$t("list.list_title_placeholder"),onKeypress:I(l,["enter"])},null,40,Ke),[[G,t(v)]])]),e("div",ze,[e("button",{flex:"~ row","gap-x-2":"","items-center":"","btn-solid":"",disabled:!t(R)||t(h)},[t(h)?(n(),m("span",Ae,Ie)):(n(),m("span",Je)),J(" "+b(o.$t("list.create")),1)],8,qe)])],42,Fe),t(r)?(n(),$(B,{key:0,id:"create-list-error","described-by":"create-list-failed",class:"rounded-bs-is-0 rounded-bs-ie-0 border-t-dashed m-b-2"},{default:i(()=>[e("header",Pe,[e("div",Xe,[Oe,e("p",null,b(o.$t("list.error")),1)]),w(T,{placement:"bottom",content:o.$t("list.clear_error"),"no-auto-focus":""},{default:i(()=>[e("button",{flex:"","rounded-4":"",p1:"","hover:bg-active":"","cursor-pointer":"","transition-100":"","aria-label":o.$t("list.clear_error"),onClick:y[1]||(y[1]=s=>_(!0))},Ye,8,Qe)]),_:1},8,["content"])]),e("ol",Ze,[e("li",et,[e("strong",tt,b(o.$t("list.error_prefix")),1),e("span",null,b(t(r)),1)])])]),_:1})):L("",!0)]),_:1},8,["paginator"])])]),_:3})}}});export{rt as default};
